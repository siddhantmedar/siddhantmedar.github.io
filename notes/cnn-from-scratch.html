<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNN From Scratch in NumPy - Complete Implementation Guide | Siddhant Medar</title>
    <meta name="description" content="Learn how to implement a Convolutional Neural Network (CNN) from scratch using only NumPy. Covers He initialization, padding, stride, and the complete forward pass with detailed code.">
    <meta name="keywords" content="CNN from scratch, convolutional neural network NumPy, implement CNN Python, He initialization, convolution layer tutorial, deep learning from scratch">
    <meta name="author" content="Siddhant Medar">
    <link rel="canonical" href="https://siddhantmedar.github.io/notes/cnn-from-scratch.html">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://siddhantmedar.github.io/notes/cnn-from-scratch.html">
    <meta property="og:title" content="CNN From Scratch in NumPy - Complete Implementation Guide">
    <meta property="og:description" content="Learn how to implement a Convolutional Neural Network from scratch using only NumPy. Covers He initialization, padding, stride, and forward pass.">
    <meta property="og:site_name" content="Siddhant Medar">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CNN From Scratch in NumPy">
    <meta name="twitter:description" content="Implement a CNN convolution layer using only NumPy - no PyTorch, no TensorFlow.">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechArticle",
        "headline": "CNN From Scratch in NumPy - Complete Implementation Guide",
        "description": "Learn how to implement a Convolutional Neural Network from scratch using only NumPy with He initialization, padding, and stride.",
        "author": {
            "@type": "Person",
            "name": "Siddhant Medar",
            "url": "https://siddhantmedar.github.io"
        },
        "publisher": {
            "@type": "Person",
            "name": "Siddhant Medar"
        },
        "mainEntityOfPage": "https://siddhantmedar.github.io/notes/cnn-from-scratch.html",
        "keywords": ["CNN", "Convolutional Neural Network", "NumPy", "Deep Learning", "Machine Learning", "Python"],
        "programmingLanguage": "Python"
    }
    </script>

    <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%);
            min-height: 100vh;
        }
        ::selection {
            background: rgba(99, 102, 241, 0.4);
            color: #fff;
        }
        .nav-link {
            position: relative;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        .nav-link.active {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
        }
        .code-block {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            overflow: hidden;
            margin: 24px 0;
        }
        .code-block-header {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .code-block-header span {
            color: #6b7280;
            font-size: 13px;
            font-weight: 500;
        }
        .code-block pre {
            margin: 0;
            padding: 20px;
            overflow-x: auto;
        }
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            white-space: pre;
            font-size: 17px;
            line-height: 1.7;
        }
        .hljs {
            background: transparent !important;
            padding: 0 !important;
        }
        .copy-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #6b7280;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }
        .copy-btn.copied {
            color: #4ade80;
            border-color: rgba(74, 222, 128, 0.3);
        }
        .fade-in {
            animation: fadeIn 0.8s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .article-title {
            background: linear-gradient(135deg, #fff 0%, #a5b4fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .concept-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            margin: 8px 0;
            transition: all 0.3s ease;
        }
        .concept-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(99, 102, 241, 0.3);
        }
        .section-title {
            color: #a5b4fc;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 16px;
        }
        h2.heading {
            color: white;
            font-size: 24px;
            font-weight: 600;
            margin-top: 48px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <nav class="fixed top-0 right-0 p-6 z-50">
        <div class="flex space-x-2">
            <a href="../index.html" class="nav-link text-gray-400 hover:text-white transition">Home</a>
            <a href="index.html" class="nav-link active text-white transition">Notes</a>
        </div>
    </nav>
    <div class="max-w-4xl mx-auto px-6 py-12 pt-24 fade-in">
        <a href="index.html" class="back-link text-gray-400 hover:text-white transition text-sm mb-8 inline-flex">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to Notes
        </a>

        <article>
            <h1 class="text-4xl md:text-5xl font-bold article-title mb-3">CNN From Scratch</h1>
            <p class="text-gray-400 text-lg mb-10">NumPy implementation of a 2D convolution layer</p>

            <div class="text-gray-300 space-y-4" style="font-size: 17px; line-height: 1.8;">
                <p>A minimal implementation of a CNN convolution layer using only NumPy. No PyTorch, no TensorFlow - just matrix operations.</p>

                <h2 class="heading">Key Concepts</h2>
                <div class="space-y-3">
                    <div class="concept-card">
                        <strong class="text-white">He initialization</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">Weights initialized with std = sqrt(2/fan_in) for better gradient flow</p>
                    </div>
                    <div class="concept-card">
                        <strong class="text-white">Padding</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">Zero-padding to control output dimensions</p>
                    </div>
                    <div class="concept-card">
                        <strong class="text-white">Stride</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">Step size for sliding the kernel</p>
                    </div>
                    <div class="concept-card">
                        <strong class="text-white">Output formula</strong>
                        <p class="text-gray-400 mt-1 font-mono" style="font-size: 17px;">((H - K + 2P) / S) + 1</p>
                    </div>
                </div>

                <h2 class="heading">Implementation</h2>
                <div class="code-block">
                    <div class="code-block-header">
                        <span>python</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            Copy
                        </button>
                    </div>
                    <pre><code class="language-python">import numpy as np


class CNNFromScratch:
    def __init__(self, in_channels, out_channels, kernel_size, padding, stride=1, bias=False):
        self.in_channels = in_channels
        self.out_channels = out_channels
        self.kernel_size = kernel_size
        self.padding = padding
        self.stride = stride
        self.bias = np.random.randn(self.out_channels) if bias else None  # (C_out,)

        # He initialization
        f_in = self.kernel_size ** 2 * self.in_channels  # fan_in = K * K * C_in
        std = np.sqrt(2 / f_in)
        self.weight = np.random.randn(
            self.out_channels, self.in_channels, self.kernel_size, self.kernel_size
        ) * std  # (C_out, C_in, K, K)

    def forward(self, x):  # x: (B, C_in, H, W)
        B, C, H, W = x.shape

        # Apply padding
        if self.padding > 0:
            x = np.pad(
                x,
                pad_width=(
                    (0, 0),                          # batch
                    (0, 0),                          # channel
                    (self.padding, self.padding),   # height
                    (self.padding, self.padding)    # width
                ),
                mode='constant'
            )  # x: (B, C_in, H + 2P, W + 2P)

        # Output dimensions
        H_out = ((H - self.kernel_size + 2 * self.padding) // self.stride) + 1
        W_out = ((W - self.kernel_size + 2 * self.padding) // self.stride) + 1

        output = np.zeros((B, self.out_channels, H_out, W_out))  # (B, C_out, H_out, W_out)

        # Convolution
        for b in range(B):
            for c_out in range(self.out_channels):
                for i in range(H_out):
                    for j in range(W_out):
                        h_start = i * self.stride
                        h_end = h_start + self.kernel_size
                        w_start = j * self.stride
                        w_end = w_start + self.kernel_size

                        x_patch = x[b, :, h_start:h_end, w_start:w_end]  # (C_in, K, K)
                        conv_sum = np.sum(x_patch * self.weight[c_out])  # (C_in, K, K) * (C_in, K, K) -> scalar

                        if self.bias is not None:
                            conv_sum += self.bias[c_out]  # scalar + scalar

                        output[b, c_out, i, j] = conv_sum

        return output  # (B, C_out, H_out, W_out)


# Test
if __name__ == "__main__":
    conv = CNNFromScratch(in_channels=3, out_channels=5, kernel_size=3, padding=1, stride=1, bias=True)
    x = np.random.randn(1, 3, 8, 8)  # (B=1, C_in=3, H=8, W=8)
    out = conv.forward(x)
    print(out.shape)  # (1, 5, 8, 8) -> (B, C_out, H_out, W_out)</code></pre>
                </div>

                <h2 class="heading">Complexity</h2>
                <div class="space-y-3">
                    <div class="concept-card">
                        <strong class="text-white">Time</strong>
                        <p class="text-gray-400 mt-1 font-mono" style="font-size: 17px;">O(B * C_out * H_out * W_out * C_in * K * K)</p>
                    </div>
                    <div class="concept-card">
                        <strong class="text-white">Space</strong>
                        <p class="text-gray-400 mt-1 font-mono" style="font-size: 17px;">O(B * C_out * H_out * W_out) for output</p>
                    </div>
                </div>

                <h2 class="heading">Further Reading</h2>
                <div class="space-y-3">
                    <a href="https://cs231n.github.io/convolutional-networks/" target="_blank" rel="noopener noreferrer" class="concept-card block hover:border-indigo-400">
                        <strong class="text-white">CS231n: Convolutional Neural Networks</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">Stanford's comprehensive guide to CNNs, covering architecture, layers, and practical considerations.</p>
                    </a>
                    <a href="https://arxiv.org/abs/1603.07285" target="_blank" rel="noopener noreferrer" class="concept-card block hover:border-indigo-400">
                        <strong class="text-white">A Guide to Convolution Arithmetic</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">Technical paper explaining convolution operations, padding, stride, and transposed convolutions.</p>
                    </a>
                    <a href="https://arxiv.org/abs/1502.01852" target="_blank" rel="noopener noreferrer" class="concept-card block hover:border-indigo-400">
                        <strong class="text-white">Delving Deep into Rectifiers (He Initialization)</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">The original paper introducing He initialization for deep networks with ReLU activations.</p>
                    </a>
                    <a href="https://setosa.io/ev/image-kernels/" target="_blank" rel="noopener noreferrer" class="concept-card block hover:border-indigo-400">
                        <strong class="text-white">Image Kernels Explained Visually</strong>
                        <p class="text-gray-400 mt-1" style="font-size: 17px;">Interactive visualization of how convolution kernels transform images - blur, sharpen, edge detection.</p>
                    </a>
                </div>
            </div>
        </article>
    </div>
    <footer class="py-12 text-center">
        <p class="text-gray-600 text-sm">Â© 2025 Siddhant Medar</p>
    </footer>
    <script>
        function copyCode(btn) {
            const codeBlock = btn.closest('.code-block');
            const code = codeBlock.querySelector('code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> Copied!`;
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy`;
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>
</html>
